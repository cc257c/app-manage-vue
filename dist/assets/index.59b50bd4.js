import{c as ee,a3 as I,i as o,ba as ie,a as T,bd as ce,dL as de,n as C,ef as ue,cs as pe,eg as fe,bi as me,bj as ge,bF as he,s as g,eh as be,f as M,Z as te,aD as ye,c0 as ne,ah as $,as as _,au as b,bR as ve,o as y,j as w,x as m,w as Ce,h as L,ay as B,bn as Me,bl as He,c8 as Fe,b as oe,F as ke,k as z,q as Se,y as A,z as q,av as W,dc as $e,bE as Be,aj as V,at as ae,aw as Z,ax as G,az as J,aA as K,aq as X,dZ as we,t as le,d_ as Oe,ag as x,ak as Pe,dY as se,ar as Te,aB as Re}from"./index.da8cb631.js";import{u as De}from"./useWindowSizeFn.c221d32f.js";import{F as Ne,a as We}from"./FullscreenOutlined.556a26d5.js";const{t:Q}=ee(),_e={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:Q("common.cancelText")},okText:{type:String,default:Q("common.okText")},closeFunc:Function},U=Object.assign({},_e,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function Ee(e){const a=(n,r)=>getComputedStyle(n)[r],c=n=>{if(!n)return;n.setAttribute("data-drag",o(e.draggable));const r=n.querySelector(".ant-modal-header"),t=n.querySelector(".ant-modal");!r||!t||!o(e.draggable)||(r.style.cursor="move",r.onmousedown=l=>{if(!l)return;const u=l.clientX,d=l.clientY,p=document.body.clientWidth,f=document.documentElement.clientHeight,h=t.offsetWidth,v=t.offsetHeight,H=t.offsetLeft,F=p-t.offsetLeft-h,k=t.offsetTop,E=f-t.offsetTop-v,O=a(t,"left"),R=a(t,"top");let D=+O,N=+R;O.includes("%")?(D=+document.body.clientWidth*(+O.replace(/%/g,"")/100),N=+document.body.clientHeight*(+R.replace(/%/g,"")/100)):(D=+O.replace(/px/g,""),N=+R.replace(/px/g,"")),document.onmousemove=function(j){let i=j.clientX-u,S=j.clientY-d;-i>H?i=-H:i>F&&(i=F),-S>k?S=-k:S>E&&(S=E),t.style.cssText+=`;left:${i+D}px;top:${S+N}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},s=()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const r of Array.from(n)){if(!r)continue;const t=a(r,"display"),l=r.getAttribute("data-drag");t!=="none"&&(l===null||o(e.destroyOnClose))&&c(r)}};I(()=>{!o(e.visible)||!o(e.draggable)||ie(()=>{s()},30)})}function je(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!pe(e)}var xe=T({name:"Modal",inheritAttrs:!1,props:U,emits:["cancel"],setup(e,{slots:a,emit:c}){const{visible:s,draggable:n,destroyOnClose:r}=ce(e),t=de();Ee({visible:s,destroyOnClose:r,draggable:n});const l=u=>{c("cancel",u)};return()=>{let u;const d={...o(t),...e,onCancel:l};return C(fe,d,je(u=ue(a))?u:{default:()=>[u]})}}});const re=Symbol();function Le(e){return me(e,re)}function it(){return ge(re)}const Ie={loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},Ve=T({name:"ModalWrapper",components:{ScrollContainer:he},inheritAttrs:!1,props:Ie,emits:["height-change","ext-height"],setup(e,{emit:a}){const c=g(null),s=g(null),n=g(0),r=g(0);let t=0;De(d.bind(null,!1)),be(s,()=>{d()},{attributes:!0,subtree:!0}),Le({redoModalHeight:d});const l=M(()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${o(n)}px`}));I(()=>{e.useWrapper&&d()}),te(()=>e.fullScreen,p=>{d(),p?r.value=n.value:n.value=r.value}),ye(()=>{const{modalHeaderHeight:p,modalFooterHeight:f}=e;a("ext-height",p+f)}),ne(()=>{});async function u(){$(()=>{const p=o(c);!p||p?.scrollTo?.(0)})}async function d(){if(!e.visible)return;const p=o(c);if(!p)return;const f=p.$el.parentElement;if(!!f){f.style.padding="0",await $();try{const h=f.parentElement&&f.parentElement.parentElement;if(!h)return;const v=getComputedStyle(h).top,H=Number.parseInt(v);let F=window.innerHeight-H*2+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;H<40&&(F-=26),await $();const k=o(s);if(!k)return;await $(),t=k.scrollHeight,e.fullScreen?n.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:n.value=e.height?e.height:t>F?F:t,a("height-change",o(n))}catch(h){}}}return{wrapperRef:c,spinRef:s,spinStyle:l,scrollTop:u,setModalHeight:d}}}),ze=["loading-tip"];function Ae(e,a,c,s,n,r){const t=b("ScrollContainer"),l=ve("loading");return y(),w(t,{ref:"wrapperRef"},{default:m(()=>[Ce((y(),L("div",{ref:"spinRef",style:Me(e.spinStyle),"loading-tip":e.loadingTip},[B(e.$slots,"default")],12,ze)),[[l,e.loading]])]),_:3},512)}var qe=_(Ve,[["render",Ae]]);const Ye=T({name:"ModalClose",components:{Tooltip:He,FullscreenExitOutlined:Ne,FullscreenOutlined:We,CloseOutlined:Fe},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:a}){const{prefixCls:c}=oe("basic-modal-close"),{t:s}=ee(),n=M(()=>[c,`${c}--custom`,{[`${c}--can-full`]:e.canFullscreen}]);function r(l){a("cancel",l)}function t(l){l?.stopPropagation(),l?.preventDefault(),a("fullscreen")}return{t:s,getClass:n,prefixCls:c,handleCancel:r,handleFullScreen:t}}});function Xe(e,a,c,s,n,r){const t=b("FullscreenExitOutlined"),l=b("Tooltip"),u=b("FullscreenOutlined"),d=b("CloseOutlined");return y(),L("div",{class:Se(e.getClass)},[e.canFullscreen?(y(),L(ke,{key:0},[e.fullScreen?(y(),w(l,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:m(()=>[C(t,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"])):(y(),w(l,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:m(()=>[C(u,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])]),_:1},8,["title"]))],64)):z("",!0),C(l,{title:e.t("component.modal.close"),placement:"bottom"},{default:m(()=>[C(d,{onClick:e.handleCancel},null,8,["onClick"])]),_:1},8,["title"])],2)}var Ue=_(Ye,[["render",Xe]]);const Ze=T({name:"BasicModalFooter",props:U,emits:["ok","cancel"],setup(e,{emit:a}){function c(n){a("ok",n)}function s(n){a("cancel",n)}return{handleOk:c,handleCancel:s}}});function Ge(e,a,c,s,n,r){const t=b("a-button");return y(),L("div",null,[B(e.$slots,"insertFooter"),e.showCancelBtn?(y(),w(t,W({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:m(()=>[A(q(e.cancelText),1)]),_:1},16,["onClick"])):z("",!0),B(e.$slots,"centerFooter"),e.showOkBtn?(y(),w(t,W({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:m(()=>[A(q(e.okText),1)]),_:1},16,["type","onClick","loading"])):z("",!0),B(e.$slots,"appendFooter")])}var Je=_(Ze,[["render",Ge]]);const Ke=T({name:"BasicModalHeader",components:{BasicTitle:$e},props:{helpMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"]});function Qe(e,a,c,s,n,r){const t=b("BasicTitle");return y(),w(t,{helpMessage:e.helpMessage},{default:m(()=>[A(q(e.title),1)]),_:1},8,["helpMessage"])}var et=_(Ke,[["render",Qe]]);function tt(e){const a=g(!1),c=M(()=>{const n=o(e.wrapClassName)||"";return o(a)?`fullscreen-modal ${n} `:o(n)});function s(n){n&&n.stopPropagation(),a.value=!o(a)}return{getWrapClassName:c,handleFullScreen:s,fullScreenRef:a}}const nt=T({name:"BasicModal",components:{Modal:xe,ModalWrapper:qe,ModalClose:Ue,ModalFooter:Je,ModalHeader:et},inheritAttrs:!1,props:U,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:a,attrs:c}){const s=g(!1),n=g(null),r=g(null),{prefixCls:t}=oe("basic-modal"),l=g(0),u={setModalProps:O,emitVisible:void 0,redoModalHeight:()=>{$(()=>{o(r)&&o(r).setModalHeight()})}},d=X();d&&a("register",u,d.uid);const p=M(()=>({...e,...o(n)})),{handleFullScreen:f,getWrapClassName:h,fullScreenRef:v}=tt({modalWrapperRef:r,extHeightRef:l,wrapClassName:Be(p.value,"wrapClassName")}),H=M(()=>({...{...o(p),visible:o(s),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0},wrapClassName:o(h)})),F=M(()=>{const i={...c,...o(p),visible:o(s),wrapClassName:o(h)};return o(v)?V(i,["height","title"]):V(i,"title")}),k=M(()=>{if(!o(v))return o(H).height});I(()=>{s.value=!!e.visible,v.value=!!e.defaultFullscreen}),te(()=>o(s),i=>{a("visible-change",i),a("update:visible",i),d&&u.emitVisible?.(i,d.uid),$(()=>{e.scrollTop&&i&&o(r)&&o(r).scrollTop()})},{immediate:!1});async function E(i){if(i?.stopPropagation(),!i.target?.classList?.contains(t+"-close--custom")){if(e.closeFunc&&ae(e.closeFunc)){const S=await e.closeFunc();s.value=!S;return}s.value=!1,a("cancel",i)}}function O(i){n.value=we(o(n)||{},i),Reflect.has(i,"visible")&&(s.value=!!i.visible),Reflect.has(i,"defaultFullscreen")&&(v.value=!!i.defaultFullscreen)}function R(i){a("ok",i)}function D(i){a("height-change",i)}function N(i){l.value=i}function j(i){!e.canFullscreen||(i.stopPropagation(),f(i))}return{handleCancel:E,getBindValue:F,getProps:H,handleFullScreen:f,fullScreenRef:v,getMergeProps:p,handleOk:R,visibleRef:s,omit:V,modalWrapperRef:r,handleExtHeight:N,handleHeightChange:D,handleTitleDbClick:j,getWrapperHeight:k}}});function ot(e,a,c,s,n,r){const t=b("ModalClose"),l=b("ModalHeader"),u=b("ModalFooter"),d=b("ModalWrapper"),p=b("Modal");return y(),w(p,W(e.getBindValue,{onCancel:e.handleCancel}),Z({default:m(()=>[C(d,W({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:e.footer!==void 0&&!e.footer?0:void 0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:m(()=>[B(e.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])]),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:m(()=>[C(t,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])])},e.$slots.title?void 0:{name:"title",fn:m(()=>[C(l,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])])},e.$slots.footer?void 0:{name:"footer",fn:m(()=>[C(u,W(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),Z({_:2},[G(Object.keys(e.$slots),f=>({name:f,fn:m(h=>[B(e.$slots,f,J(K(h||{})))])}))]),1040,["onOk","onCancel"])])},G(Object.keys(e.omit(e.$slots,"default")),f=>({name:f,fn:m(h=>[B(e.$slots,f,J(K(h||{})))])}))]),1040,["onCancel"])}var at=_(nt,[["render",ot]]);const P=le({}),Y=le({});function ct(){const e=g(null),a=g(!1),c=g("");function s(t,l){if(!X())throw new Error("useModal() can only be used inside setup() or functional components!");c.value=l,ne(()=>{e.value=null,a.value=!1,P[o(c)]=null}),!(o(a)&&Oe()&&t===o(e))&&(e.value=t,a.value=!0,t.emitVisible=(u,d)=>{Y[d]=u})}const n=()=>{const t=o(e);return t||se("useModal instance is undefined!"),t},r={setModalProps:t=>{n()?.setModalProps(t)},getVisible:M(()=>Y[~~o(c)]),redoModalHeight:()=>{n()?.redoModalHeight?.()},openModal:(t=!0,l,u=!0)=>{if(n()?.setModalProps({visible:t}),!l)return;const d=o(c);if(u){P[d]=null,P[d]=x(l);return}Pe(x(P[d]),x(l))||(P[d]=x(l))},closeModal:()=>{n()?.setModalProps({visible:!1})}};return[s,r]}const dt=e=>{const a=g(null),c=X(),s=g(""),n=()=>{const t=o(a);return t||se("useModalInner instance is undefined!"),t},r=(t,l)=>{Te(()=>{a.value=null}),s.value=l,a.value=t,c?.emit("register",t,l)};return I(()=>{const t=P[o(s)];!t||!e||!ae(e)||$(()=>{e(t)})}),[r,{changeLoading:(t=!0)=>{n()?.setModalProps({loading:t})},getVisible:M(()=>Y[~~o(s)]),changeOkLoading:(t=!0)=>{n()?.setModalProps({confirmLoading:t})},closeModal:()=>{n()?.setModalProps({visible:!1})},setModalProps:t=>{n()?.setModalProps(t)},redoModalHeight:()=>{const t=n()?.redoModalHeight;t&&t()}}]},ut=Re(at);export{ut as B,dt as a,ct as b,it as u};
