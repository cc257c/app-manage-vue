import{B as b,a as w}from"./index.59b50bd4.js";import{B as A}from"./BasicForm.4eff3114.js";import{u as C}from"./useForm.8ce8a1bf.js";import{i as I,g as v,a as D}from"./system.b1c25c76.js";import{as as _,a as M,s as d,i as s,f as E,au as p,o as P,j as k,x as S,n as x,av as y}from"./index.da8cb631.js";const V=[{title:"\u7528\u6237\u540D",dataIndex:"account",width:120},{title:"\u6635\u79F0",dataIndex:"nickname",width:120},{title:"\u90AE\u7BB1",dataIndex:"email",width:120},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",width:180},{title:"\u89D2\u8272",dataIndex:"role",width:200},{title:"\u5907\u6CE8",dataIndex:"remark"}],z=[{field:"account",label:"\u7528\u6237\u540D",component:"Input",colProps:{span:8}},{field:"nickname",label:"\u6635\u79F0",component:"Input",colProps:{span:8}}],q=[{field:"account",label:"\u7528\u6237\u540D",component:"Input",helpMessage:["\u672C\u5B57\u6BB5\u6F14\u793A\u5F02\u6B65\u9A8C\u8BC1","\u4E0D\u80FD\u8F93\u5165\u5E26\u6709admin\u7684\u7528\u6237\u540D"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},{validator(t,u){return new Promise((e,a)=>{I(u).then(()=>e()).catch(n=>{a(n.message||"\u9A8C\u8BC1\u5931\u8D25")})})}}]},{field:"pwd",label:"\u5BC6\u7801",component:"InputPassword",required:!0,ifShow:!1},{label:"\u89D2\u8272",field:"role",component:"ApiSelect",componentProps:{api:v,labelField:"roleName",valueField:"roleValue"},required:!0},{field:"dept",label:"\u6240\u5C5E\u90E8\u95E8",component:"TreeSelect",componentProps:{fieldNames:{label:"deptName",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"\u6635\u79F0",component:"Input",required:!0},{label:"\u90AE\u7BB1",field:"email",component:"Input",required:!0},{label:"\u5907\u6CE8",field:"remark",component:"InputTextArea"}],T=M({name:"AccountModal",components:{BasicModal:b,BasicForm:A},emits:["success","register"],setup(t,{emit:u}){const e=d(!0),a=d(""),[n,{setFieldsValue:c,updateSchema:r,resetFields:l,validate:m}]=C({labelWidth:100,baseColProps:{span:24},schemas:q,showActionButtonGroup:!1,actionColOptions:{span:23}}),[f,{setModalProps:i,closeModal:F}]=w(async o=>{l(),i({confirmLoading:!1}),e.value=!!o?.isUpdate,s(e)&&(a.value=o.record.id,c({...o.record}));const h=await D();r([{field:"pwd",show:!s(e)},{field:"dept",componentProps:{treeData:h}}])}),g=E(()=>s(e)?"\u7F16\u8F91\u8D26\u53F7":"\u65B0\u589E\u8D26\u53F7");async function B(){try{const o=await m();i({confirmLoading:!0}),F(),u("success",{isUpdate:s(e),values:{...o,id:a.value}})}finally{i({confirmLoading:!1})}}return{registerModal:f,registerForm:n,getTitle:g,handleSubmit:B}}});function $(t,u,e,a,n,c){const r=p("BasicForm"),l=p("BasicModal");return P(),k(l,y(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:S(()=>[x(r,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var L=_(T,[["render",$]]),G=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));export{L as A,G as a,V as c,z as s};
