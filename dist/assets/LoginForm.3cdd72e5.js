import{a as b,I as g,c as k,b as C,r as D,s as u,t as B,f as N,i as e,o as z,h as E,w as f,v as y,n as o,x as n,B as R,y as T,z as $,C as K,F as M,D as U}from"./index.da8cb631.js";/* empty css              *//* empty css              */import{u as V,a as P,L as q,_ as G,b as O}from"./LoginFormTitle.a51ffff2.js";import{F as w}from"./Form.57dd9f37.js";import"./Col.c878cfca.js";import"./useFlexGapSupport.63e06d71.js";import"./_baseIteratee.58bea659.js";import"./get.8113fc0b.js";import"./useSize.3251a39b.js";const ae=b({__name:"LoginForm",setup(j){const l=w.Item,v=g.Password,{t:a}=k(),{notification:x,createErrorModal:_}=U(),{prefixCls:S}=C("login"),F=D(),{setLoginState:A,getLoginState:h}=V(),{getFormRules:I}=P(),m=u(),i=u(!1);u(!1);const t=B({account:"",password:""}),{validForm:L}=O(m),p=N(()=>e(h)===q.LOGIN);async function d(){const r=await L();if(!!r)try{i.value=!0;const s=await F.login({password:r.password,username:r.account,mode:"none"});s&&x.success({message:a("sys.login.loginSuccessTitle"),description:`${a("sys.login.loginSuccessDesc")}: ${s.realName}`,duration:3})}catch(s){_({title:a("sys.api.errorTip"),content:s.message||a("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${S}`)||document.body})}finally{i.value=!1}}return(r,s)=>(z(),E(M,null,[f(o(G,{class:"enter-x"},null,512),[[y,e(p)]]),f(o(e(w),{class:"p-4 enter-x",model:t,rules:e(I),ref_key:"formRef",ref:m,onKeypress:K(d,["enter"])},{default:n(()=>[o(e(l),{name:"account",class:"enter-x"},{default:n(()=>[o(e(g),{size:"large",value:t.account,"onUpdate:value":s[0]||(s[0]=c=>t.account=c),placeholder:e(a)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),o(e(l),{name:"password",class:"enter-x"},{default:n(()=>[o(e(v),{size:"large",visibilityToggle:"",value:t.password,"onUpdate:value":s[1]||(s[1]=c=>t.password=c),placeholder:e(a)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),o(e(l),{class:"enter-x"},{default:n(()=>[o(e(R),{type:"primary",size:"large",block:"",onClick:d,loading:i.value},{default:n(()=>[T($(e(a)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[y,e(p)]])],64))}});export{ae as default};
