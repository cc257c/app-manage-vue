import{a as S,aF as K,b as Q,f as b,aH as ee,as as T,au as _,o as I,h as O,n as o,x as L,ay as te,F as ne,ax as oe,j as X,aw as re,av as M,az as ie,q as ae,t as se,s as N,a3 as le,i as p,c8 as ce,y as B,cZ as ue,c_ as me,eW as ge,eX as de}from"./index.da8cb631.js";import{I as R}from"./index.e4b8d817.js";import{a as pe}from"./index.4fb91daf.js";import"./index.13fe2a9f.js";import"./index.2a671509.js";import"./useSize.3251a39b.js";import"./eagerComputed.d5d9fa51.js";import"./index.0961799f.js";import"./useFlexGapSupport.63e06d71.js";import"./useWindowSizeFn.c221d32f.js";import"./useContentViewHeight.f6c045c6.js";import"./ArrowLeftOutlined.da248543.js";import"./index.17402399.js";import"./transButton.af3d1515.js";const fe=S({name:"ImagePreview",components:{Image:R,PreviewGroup:R.PreviewGroup},props:{functional:K.bool,imageList:{type:Array}},setup(n){const{prefixCls:c}=Q("image-preview"),a=b(()=>{const{imageList:u}=n;return u?u.map(t=>ee(t)?{src:t,placeholder:!1}:t):[]});return{prefixCls:c,getImageList:a}}});function ve(n,c,a,u,t,h){const g=_("Image"),f=_("PreviewGroup");return I(),O("div",{class:ae(n.prefixCls)},[o(f,null,{default:L(()=>[!n.imageList||n.$slots.default?te(n.$slots,"default",{key:0}):(I(!0),O(ne,{key:1},oe(n.getImageList,s=>(I(),X(g,ie(M({key:s.src},s)),re({_:2},[s.placeholder?{name:"placeholder",fn:L(()=>[o(g,M(s,{src:s.placeholder,preview:!1}),null,16,["src"])])}:void 0]),1040))),128))]),_:3})],2)}var _e=T(fe,[["render",ve]]),he="/assets/resume.8f27866b.svg",we="/assets/p-rotate.cb8bbfc3.svg",xe="/assets/scale.44abde22.svg",be="/assets/unscale.c552f416.svg",Ie="/assets/unrotate.ef6a2daf.svg",d;(function(n){n[n.LOADING=0]="LOADING",n[n.DONE=1]="DONE",n[n.FAIL=2]="FAIL"})(d||(d={}));const Le={show:{type:Boolean,default:!1},imageList:{type:[Array],default:null},index:{type:Number,default:0},scaleStep:{type:Number},defaultWidth:{type:Number},maskClosable:{type:Boolean},rememberState:{type:Boolean}},i="img-preview";var ye=S({name:"ImagePreview",props:Le,emits:["img-load","img-error"],setup(n,{expose:c,emit:a}){const u=new Map,t=se({currentUrl:"",imgScale:1,imgRotate:0,imgTop:0,imgLeft:0,status:d.LOADING,currentIndex:0,moveX:0,moveY:0,show:n.show}),h=N(null),g=N(null);function f(){G();const{index:e,imageList:r}=n;if(!r||!r.length)throw new Error("imageList is undefined");t.currentIndex=e,F(r[e])}function s(){t.imgScale=1,t.imgRotate=0,t.imgTop=0,t.imgLeft=0}function G(){const e=p(h);!e||(e.onmousewheel=y,document.body.addEventListener("DOMMouseScroll",y),document.ondragstart=function(){return!1})}const w=b(()=>{const e=n?.scaleStep??0;return e??0>0?e/100:t.imgScale/10});function y(e){e=e||window.event,e.delta=e.wheelDelta||-e.detail,e.preventDefault(),e.delta>0&&x(w.value),e.delta<0&&x(-w.value)}function x(e){t.imgScale<=.2&&e<0||(t.imgScale+=e)}function k(e){t.imgRotate+=e}function Y(){const e=p(g);!e||(e.onmousemove=null)}function F(e){t.status=d.LOADING;const r=new Image;r.src=e,r.onload=l=>{if(t.currentUrl!==e){const m=l.composedPath();if(n.rememberState){u.set(t.currentUrl,{scale:t.imgScale,top:t.imgTop,left:t.imgLeft,rotate:t.imgRotate});const v=u.get(e);v?(t.imgScale=v.scale,t.imgTop=v.top,t.imgRotate=v.rotate,t.imgLeft=v.left):(s(),n.defaultWidth&&(t.imgScale=n.defaultWidth/m[0].naturalWidth))}else n.defaultWidth&&(t.imgScale=n.defaultWidth/m[0].naturalWidth);m&&a("img-load",{index:t.currentIndex,dom:m[0],url:e})}t.currentUrl=e,t.status=d.DONE},r.onerror=l=>{const m=l.composedPath();m&&a("img-error",{index:t.currentIndex,dom:m[0],url:e}),t.status=d.FAIL}}function P(e){e&&e.stopPropagation(),D()}function D(){t.show=!1,document.body.removeEventListener("DOMMouseScroll",y),document.ondragstart=null}function E(){s()}c({resume:E,close:D,prev:$.bind(null,"left"),next:$.bind(null,"right"),setScale:e=>{e>0&&e<=10&&(t.imgScale=e)},setRotate:e=>{t.imgRotate=e}});function $(e){const{currentIndex:r}=t,{imageList:l}=n;e==="left"&&(t.currentIndex--,r<=0&&(t.currentIndex=l.length-1)),e==="right"&&(t.currentIndex++,r>=l.length-1&&(t.currentIndex=0)),F(l[t.currentIndex])}function U(e){e=e||window.event,t.moveX=e.clientX,t.moveY=e.clientY;const r=p(g);r&&(r.onmousemove=j)}function j(e){e=e||window.event,e.preventDefault();const r=e.clientX-t.moveX,l=e.clientY-t.moveY;t.imgLeft+=r,t.imgTop+=l,t.moveX=e.clientX,t.moveY=e.clientY}const V=b(()=>{const{imgScale:e,imgRotate:r,imgTop:l,imgLeft:m}=t;return{transform:`scale(${e}) rotate(${r}deg)`,marginTop:`${l}px`,marginLeft:`${m}px`,maxWidth:n.defaultWidth?"unset":"100%"}}),A=b(()=>{const{imageList:e}=n;return e.length>1});le(()=>{n.show&&f(),n.imageList&&s()});const q=e=>{n.maskClosable&&e.target&&e.target.classList.contains(`${i}-content`)&&P(e)},H=()=>o("div",{class:`${i}__close`,onClick:P},[o(ce,{class:`${i}__close-icon`},null)]),Z=()=>{if(!p(A))return null;const{currentIndex:e}=t,{imageList:r}=n;return o("div",{class:`${i}__index`},[e+1,B(" / "),r.length])},J=()=>o("div",{class:`${i}__controller`},[o("div",{class:`${i}__controller-item`,onClick:()=>x(-w.value)},[o("img",{src:be},null)]),o("div",{class:`${i}__controller-item`,onClick:()=>x(w.value)},[o("img",{src:xe},null)]),o("div",{class:`${i}__controller-item`,onClick:E},[o("img",{src:he},null)]),o("div",{class:`${i}__controller-item`,onClick:()=>k(-90)},[o("img",{src:Ie},null)]),o("div",{class:`${i}__controller-item`,onClick:()=>k(90)},[o("img",{src:we},null)])]),W=e=>p(A)?o("div",{class:[`${i}__arrow`,e],onClick:()=>$(e)},[e==="left"?o(ue,null,null):o(me,null,null)]):null;return()=>t.show&&o("div",{class:i,ref:h,onMouseup:Y,onClick:q},[o("div",{class:`${i}-content`},[o("img",{style:p(V),class:[`${i}-image`,t.status===d.DONE?"":"hidden"],ref:g,src:t.currentUrl,onMousedown:U},null),H(),Z(),J(),W("left"),W("right")])])}});let C=null;function $e(n){if(!ge)return;const c={},a=document.createElement("div");return Object.assign(c,{show:!0,index:0,scaleStep:100},n),C=o(ye,c),de(C,a),document.body.appendChild(a),C.component?.exposed}const z=["https://picsum.photos/id/66/346/216","https://picsum.photos/id/67/346/216","https://picsum.photos/id/68/346/216"],Ce=S({components:{PageWrapper:pe,ImagePreview:_e},setup(){function n(){$e({imageList:z,defaultWidth:700,rememberState:!0,onImgLoad:({index:a,url:u,dom:t})=>{a+1,`${u}`}})}return{imgList:z,openImg:n}}}),Se=B("\u65E0\u9884\u89C8\u56FE");function ke(n,c,a,u,t,h){const g=_("ImagePreview"),f=_("a-button"),s=_("PageWrapper");return I(),X(s,{title:"\u56FE\u7247\u9884\u89C8\u793A\u4F8B"},{default:L(()=>[o(g,{imageList:n.imgList},null,8,["imageList"]),o(f,{onClick:n.openImg,type:"primary"},{default:L(()=>[Se]),_:1},8,["onClick"])]),_:1})}var Ge=T(Ce,[["render",ke]]);export{Ge as default};
