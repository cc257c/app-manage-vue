import{c as L,a as z,t as C,s as D,de as q,f as w,Z as V,a3 as H,i as d,ba as X,n as g,dd as W,d0 as G,fq as J,av as K,fr as O,aB as F}from"./index.da8cb631.js";const{t:j}=L(),Z={value:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:[String],default:j("component.verify.dragText")},successText:{type:[String],default:j("component.verify.successText")},height:{type:[Number,String],default:40},width:{type:[Number,String],default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:{}},contentStyle:{type:Object,default:{}},barStyle:{type:Object,default:{}},actionStyle:{type:Object,default:{}}},Q={...Z,src:{type:String},imgWidth:{type:Number,default:260},imgWrapStyle:{type:Object,default:{}},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270},diffDegree:{type:Number,default:20}};var A=z({name:"BaseDargVerify",props:Z,emits:["success","update:value","change","start","move","end"],setup(a,{emit:m,slots:R,expose:E}){const e=C({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),n=D(null),v=D(null),_=D(null),x=D(null);q({el:document,name:"mouseup",listener:()=>{e.isMoving&&p()}});const I=w(()=>{const{height:t,actionStyle:o}=a,r=`${parseInt(t)}px`;return{left:0,width:r,height:r,...o}}),P=w(()=>{const{height:t,width:o,circle:r,wrapStyle:i}=a,c=parseInt(t);return{width:`${parseInt(o)}px`,height:`${c}px`,lineHeight:`${c}px`,borderRadius:r?c/2+"px":0,...i}}),M=w(()=>{const{height:t,circle:o,barStyle:r}=a,i=parseInt(t);return{height:`${i}px`,borderRadius:o?i/2+"px 0 0 "+i/2+"px":0,...r}}),$=w(()=>{const{height:t,width:o,contentStyle:r}=a,i=`${parseInt(t)}px`,c=`${parseInt(o)}px`;return{height:i,width:c,...r}});V(()=>e.isPassing,t=>{if(t){const{startTime:o,endTime:r}=e,i=(r-o)/1e3;m("success",{isPassing:t,time:i.toFixed(1)}),m("update:value",t),m("change",t)}}),H(()=>{e.isPassing=!!a.value});function T(t){return t.pageX||t.touches[0].pageX}function S(t){if(e.isPassing)return;const o=d(x);!o||(m("start",t),e.moveDistance=T(t)-parseInt(o.style.left.replace("px",""),10),e.startTime=new Date().getTime(),e.isMoving=!0)}function s(t){const o=parseInt(t.style.width),{width:r}=a,i=parseInt(r);return{offset:i-o-6,widthNum:i,actionWidth:o}}function l(t){const{isMoving:o,moveDistance:r}=e;if(o){const i=d(x),c=d(v);if(!i||!c)return;const{offset:u,widthNum:b,actionWidth:k}=s(i),h=T(t)-r;m("move",{event:t,moveDistance:r,moveX:h}),h>0&&h<=u?(i.style.left=`${h}px`,c.style.width=`${h+k/2}px`):h>u&&(i.style.left=`${b-k}px`,c.style.width=`${b-k/2}px`,a.isSlot||y())}}function f(t){const{isMoving:o,isPassing:r,moveDistance:i}=e;if(o&&!r){m("end",t);const c=d(x),u=d(v);if(!c||!u)return;const b=T(t)-i,{offset:k,widthNum:h,actionWidth:B}=s(c);b<k?a.isSlot?setTimeout(()=>{if(!a.value)p();else{const N=d(_);N&&(N.style.width=`${parseInt(u.style.width)}px`)}},0):p():(c.style.left=`${h-B}px`,u.style.width=`${h-B/2}px`,y()),e.isMoving=!1}}function y(){if(a.isSlot){p();return}e.endTime=new Date().getTime(),e.isPassing=!0,e.isMoving=!1}function p(){e.isMoving=!1,e.isPassing=!1,e.moveDistance=0,e.toLeft=!1,e.startTime=0,e.endTime=0;const t=d(x),o=d(v),r=d(_);!t||!o||!r||(e.toLeft=!0,X(()=>{e.toLeft=!1,t.style.left="0",o.style.width="0"},300),r.style.width=d($).width)}return E({resume:p}),()=>{const t=()=>{const i=["darg-verify-bar"];return e.toLeft&&i.push("to-left"),g("div",{class:i,ref:v,style:d(M)},null)},o=()=>{const i=["darg-verify-content"],{isPassing:c}=e,{text:u,successText:b}=a;return c&&i.push("success"),g("div",{class:i,ref:_,style:d($)},[W(R,"text",c)||(c?b:u)])},r=()=>{const i=["darg-verify-action"],{toLeft:c,isPassing:u}=e;return c&&i.push("to-left"),g("div",{class:i,onMousedown:S,onTouchstart:S,style:d(I),ref:x},[W(R,"actionIcon",u)||(u?g(G,{class:"darg-verify-action__icon"},null):g(J,{class:"darg-verify-action__icon"},null))])};return g("div",{class:"darg-verify",ref:n,style:d(P),onMousemove:l,onTouchmove:l,onMouseleave:f,onMouseup:f,onTouchend:f},[t(),o(),r()])}}});var U=z({name:"ImgRotateDragVerify",inheritAttrs:!1,props:Q,emits:["success","change","update:value"],setup(a,{emit:m,attrs:R,expose:E}){const e=D(null),n=C({showTip:!1,isPassing:!1,imgStyle:{},randomRotate:0,currentRotate:0,toOrigin:!1,startTime:0,endTime:0,draged:!1}),{t:v}=L();V(()=>n.isPassing,s=>{if(s){const{startTime:l,endTime:f}=n,y=(f-l)/1e3;m("success",{isPassing:s,time:y.toFixed(1)}),m("change",s),m("update:value",s)}});const _=w(()=>{const{imgWrapStyle:s,imgWidth:l}=a;return{width:`${l}px`,height:`${l}px`,...s}}),x=w(()=>{const{minDegree:s,maxDegree:l}=a;return s===l?Math.floor(1+Math.random()*1)/10+1:1});function I(){n.startTime=new Date().getTime()}function P(s){n.draged=!0;const{imgWidth:l,height:f,maxDegree:y}=a,{moveX:p}=s,t=Math.ceil(p/(l-parseInt(f))*y*d(x));n.currentRotate=t,n.imgStyle=O("transform",`rotateZ(${n.randomRotate-t}deg)`)}function M(){const{minDegree:s,maxDegree:l}=a,f=Math.floor(s+Math.random()*(l-s));n.randomRotate=f,n.imgStyle=O("transform",`rotateZ(${f}deg)`)}function $(){const{randomRotate:s,currentRotate:l}=n,{diffDegree:f}=a;Math.abs(s-l)>=(f||20)?(n.imgStyle=O("transform",`rotateZ(${s}deg)`),n.toOrigin=!0,X(()=>{n.toOrigin=!1,n.showTip=!0},300)):T(),n.showTip=!0}function T(){n.isPassing=!0,n.endTime=new Date().getTime()}function S(){n.showTip=!1;const s=d(e);!s||(n.isPassing=!1,s.resume(),M())}return E({resume:S}),()=>{const{src:s}=a,{toOrigin:l,isPassing:f,startTime:y,endTime:p}=n,t=[];l&&t.push("to-origin");const o=(p-y)/1e3;return g("div",{class:"ir-dv"},[g("div",{class:"ir-dv-img__wrap",style:d(_)},[g("img",{src:s,onLoad:M,width:parseInt(a.width),class:t,style:n.imgStyle,onClick:()=>{S()},alt:"verify"},null),n.showTip&&g("span",{class:["ir-dv-img__tip",n.isPassing?"success":"error"]},[n.isPassing?v("component.verify.time",{time:o.toFixed(1)}):v("component.verify.error")]),!n.showTip&&!n.draged&&g("span",{class:["ir-dv-img__tip","normal"]},[v("component.verify.redoTip")])]),g(A,K({class:"ir-dv-drag__bar",onMove:P,onEnd:$,onStart:I,ref:e},{...R,...a},{value:f,isSlot:!0}),null)])}}});const tt=F(A),et=F(U);export{tt as B,et as R};
